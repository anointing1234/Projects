{% load static %}
{% static "img" as img %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>CnxTrade</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="{% static 'css/plugins.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/theme-styles.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/blocks.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/widgets.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.min.css' %}">

    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700i,900," rel="stylesheet">

    <style>
        .inner-form {
            border-radius: 30px;
        }
        .alert-sm {
            padding: 0.5rem 1rem;
            font-size: 10px;
        }
        .alert {
            background: white;
        }
        .alert p {
            margin-bottom: 0;
            font-size: 10px;
        }
        .form-input {
            margin: 0;
            width: 100px;
            height: 50px;
            font-size: 10px;
        }
        .form-label {
            font-size: 10px;
        }
        .btn--loading {
            pointer-events: none;
            position: relative;
        }
        .btn--loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 18px;
            height: 18px;
            border: 3px solid #fff;
            border-top-color: #000;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            to {
                transform: translate(-50%, -50%) rotate(1turn);
            }
        }
    </style>

</head>

<body class="crumina-grid">

    <div class="main-content-wrapper crumina-flying-balls particles-js bg-1">
        <section class="">
            <div class="container-fluid pt-4">
                <form method="POST" class="form-dark mt-3" action="{% url 'register' %}" id="signupForm">
                    {% csrf_token %}
                    <div class="card bg-transparent align-itme-center">
                        <div class="container bg-dark mb-5 inner-form py-3 mt-5 pt-5 col-lg-6 col-md-12 col-sm-12 col-xs-12">
                            <header class="text-center mb-4">
                                <h5 class="heading-title">Registration</h5>
                                <p class="text-light">*Please fill all fields*</p>
                            </header>
                            
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-1">
                                    <label class="form-label fs-5">Fullname<abbr class="required" title="required">:</abbr></label>
                                    {{ form.fullname }}
                                </div>
                                <div class="col-12 col-md-6 mb-1">
                                    <label class="form-label fs-5">Username<abbr class="required" title="required">:</abbr></label>
                                    {{ form.username }}
                                </div>
                                <div class="col-12 col-md-6 mb-1">
                                    <label class="form-label fs-5">Password<abbr class="required" title="required">:</abbr></label>
                                    {{ form.password1 }}
                                </div>
                                <div class="col-12 col-md-6 mb-1">
                                    <label class="form-label fs-5">Confirm password<abbr class="required" title="required">:</abbr></label>
                                    {{ form.password2 }}
                                </div>
                                <div class="col-12 col-md-12 mb-1">
                                    <label class="form-label fs-5">Email<abbr class="required" title="required">:</abbr></label>
                                    {{ form.email }}
                                </div>
                            </div>
                            
                            <div class="checkbox checkbox--style3">
                                <label class="text-light d-flex justify-content-center">
                                    <input type="checkbox" name="optionsCheckboxes10">
                                    <a class="link-underlined text-light" href="#">
                                        click if you agree with the Terms and Conditions.
                                    </a>
                                </label>
                            </div>
                            <div class="checkbox checkbox--style d-flex justify-content-center">
                                <label class="text-light ">
                                    <a class="link-underlined text-info" href="Login">Already have account? click here to login</a>
                                </label>
                            </div>
                            <div class="d-flex justify-content-center mt-2">
                                <button type="submit" class="btn px-5 btn-warning text-dark py-2" id="signupButton">
                                    Signup
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </section>
    </div>

    <footer id="site-footer" class="footer">
        <canvas id="can"></canvas>
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-12 col-sm-offset-0 col-xs-12">
                    <div class="widget w-info">
                        <a href="index-2.html">
                            <h5 class="site-logo">
                                <img height="50px" width="50px" src="{% static 'img/bitcoin_12560170.png' %}" alt="Woox">
                                Cnx
                            </h5>
                        </a>
                        <p>Welcome to Cnx Trade Investment Site, where we strive to provide clear and
                            insightful
                            information about the evolving world of trade and investment. Our goal is to
                            empower you
                            with the knowledge and tools needed to navigate the complexities of the
                            financial markets.
                        </p>
                        <p>Stay connected with us for the latest updates on investment opportunities and
                            market trends.
                            Join our community to gain valuable insights from industry experts and
                            participate in
                            discussions about the future of finance. Together, we can seize emerging
                            opportunities and
                            achieve financial success.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="sub-footer">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-12 col-sm-offset-0 col-xs-12">
                        <span id="year"></span>
                        <span><a href="index-2.html">Cnx Trade</a> - Investment changing lifes.</span>
                    </div>
                </div>
            </div>
        </div>

        <script>
            document.getElementById('year').innerText = new Date().getFullYear() + '.';
        </script>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="{% static 'js/method-assign.js' %}"></script>

    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>

    <script src="{% static 'js/map-shortcode.js' %}"></script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDDpqPQbjKiY7zSvLyPRIWWOfG1XiuhhYg" async
        defer></script>

    <script src="{% static 'js/js-plugins/leaflet.js' %}"></script>
    <script src="{% static 'js/js-plugins/MarkerClusterGroup.js' %}"></script>

    <script src="{% static 'js/js-plugins/rxjs.min.js' %}"></script>
    <script src="{% static 'js/js-plugins/waypoints.js' %}"></script>
    <script src="{% static 'js/js-plugins/imagesLoaded.js' %}"></script>
    <script src="{% static 'js/js-plugins/isotope.pkgd.min.js' %}"></
        <script src="{% static 'js/main.js' %}"></script>
        <script>
            document.getElementById('signupForm').addEventListener('submit', function () {
                const signupButton = document.getElementById('signupButton');
                signupButton.classList.add('btn--loading');
                signupButton.disabled = true;
            });
        
            // Function to display messages using SweetAlert2
            function displayMessages(messages, type) {
                messages.forEach(message => {
                    Swal.fire({
                        icon: type,
                        title: type === 'success' ? 'Success' : 'Error',
                        text: message,
                        confirmButtonText: 'OK'
                    });
                });
            }
        
            // Extract Django messages and display them with SweetAlert2
            document.addEventListener('DOMContentLoaded', function () {
                const messages = [];
                {% if messages %}
                    {% for message in messages %}
                        messages.push("{{ message }}");
                    {% endfor %}
                    displayMessages(messages, '{{ message.tags }}' === 'success' ? 'success' : 'error');
                {% endif %}
        
                const formErrors = [];
                {% if form.errors %}
                    {% for field in form %}
                        {% for error in field.errors %}
                            formErrors.push("{{ error }}");
                        {% endfor %}
                    {% endfor %}
                    {% for error in form.non_field_errors %}
                        formErrors.push("{{ error }}");
                    {% endfor %}
                    displayMessages(formErrors, 'error');
                {% endif %}
            });
        
            // Script for registration success alert
            document.addEventListener('DOMContentLoaded', function () {
                {% if registration_success %}
                    Swal.fire({
                        icon: 'success',
                        title: 'Registration Successful',
                        text: 'You can now log in.',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = "{% url 'Login' %}";
                        }
                    });
                {% endif %}
            });
        </script>
        